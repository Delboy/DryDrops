{% extends "base.html" %}
{% load static %}

{% block page_header %}
<div class="container header-container">
    <div class="row">
        <div class="col"></div>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="overlay"></div>
<div class="container">
    <div class="row mt-2">
        <div class="col">
            <h2 class="text-center">Edit Review</h2>
            <hr>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-lg-6 ">
            
            <form action="{% url 'edit_review' review.id %}" method="POST">
                {% csrf_token %}
                {% for field in form  %}
                    {% if field.name == "rating" %}
                        {{ field.label }} *
                        <br>
                        {% for radio in field %}
                            <label for="{{ radio.id_for_label }}">
                                <i class="far fa-star star"></i>
                            </label>
                            <div class="radio-tag d-inline">{{ radio.tag }}</div>
                        {% endfor %}
                        <br>
                    {% else %}
                        {{ field.errors }}
                        {{ field.label }} *
                        <br>
                        {{ field }}
                    {% endif %}
                {% endfor %}
                <div class="mt-1">
                    <a href="{% url 'product_detail' review.product.id %}" class="btn btn-outline-dark rounded-pill">Cancel</a>
                    <button type="submit" class="btn link-btn rounded-pill">Update Review</button>
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock %}

{% block postloadjs %}
{{ block.super }}
<script>
    // Checks the current rating and fills in the relevant stars
    $(document).ready(function(){
        input = $("input[type=radio][name='rating']:checked")
        star = input.parent().prev().children()
        star.click()
    });

    // Changes stars from empty to filled on selection
    $('.star').click(function(e) {
        prevStars = $(this).parent().prevAll('label').children()
        nextStars = $(this).parent().nextAll('label').children()
        
        $(this).removeClass('far').addClass('fas').css({'color':'gold'})
        prevStars.removeClass('far').addClass('fas').css({'color':'gold'})
        nextStars.removeClass('fas').addClass('far').css({'color':'black'})
    })
</script>
{% endblock %}